<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover"  />

  <title i18n="nav_title"></title>
  <meta name="descriptison">
  <meta name="keywords" content="联想语音,乐语音,联想小乐,联想语音平台,联想语音助手,moto语音助手,摩托语音助手,摩托语音,moto语音,小乐语音助手,小乐语音,联想智能语音,小乐小乐">

  <!-- Favicons -->
  <link href="../assets/img/favicon.ico" rel="icon">

  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="../assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="../assets/vendor/sweetalert/bootstrap-4.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link rel="stylesheet" href="../assets/css/only.css">
  <link href="../assets/css/style.css" rel="stylesheet">
</head>

<body>

  <div id="head-page"></div>
    <section class="service" id="head">
      <div class="head-bg d-flex justify-content-center align-items-center">
        <h2 i18n="nav_userinfo"></h2>
      </div>
      <div class="bight"></div>
    </section><!-- End header Section -->
  <main id="main" class="service-main">

    <!-- ======= document Section ======= -->
    <section class="service-main-section">
      <div class="container">
        <div class="userinfo-bg">
            <div class="con-title">我的信息</div>
            <hr/>
            <div class="con-main">
                <div class="li">
                    <span class="label-title">邮箱</span><span id="email"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">手机号</span><span id="phone"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">公司名称</span><span id="company"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">姓名</span><span id="username"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">部门名称</span><span id="dept"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">语音权限</span><span id="qx"></span>
                </div>
                <hr/>
                <div class="li">
                    <span class="label-title">密钥</span><a href="./uservice.html" class="ubtn">点击查看</a>
                </div>
            </div>
            
        </div>
      </div>
    </section><!-- End main Section -->
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
      <div class="container">
        <div class="copyright">
            <span i18n="footerFAQ"></span> 
            <a href="contact.html"></a>
        </div>
      </div>
    </footer><!-- End Footer -->

  <!-- Vendor JS Files -->
  <script src="../assets/vendor/jquery/jquery.min.js"></script>
  <script src="../assets/vendor/jquery.Base64/jquery.base64.js"></script>
  <script src="../assets/js/common/iflogin.js"></script>
  <script src="../assets/js/common/isIE.js"></script>
  <script src="../i18n/ehi-i18n.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/sweetalert/sweetalert2.min.js"></script>
  <script src="../assets/vendor/recorder-core/recorder.wav.min.js"></script>
  <script src="../assets/vendor/recorder-core/waveview.js"></script>
  <script src="../assets/vendor/md5/md5.js"></script>

  <!-- Template Main JS File -->
  <script src="../assets/js/common/url.js"></script>
  <script src="../assets/js/common/main.js"></script>
  <script>
    $(function(){
      $('#head-page').load('../assets/head/header.html')
    })
  </script>
  <script>
      userInfo()
      function userInfo(){
        var params = {
              username:$.base64.decode(window.localStorage.getItem('un')),
              lenovoid:$.base64.decode(window.localStorage.getItem('acd')),
              t:$.base64.decode(window.localStorage.getItem('token')),
              u:"",
              p:"",
              language:"",
              phone:"",
              company:"",
              dept:"",
              lid:"",
              opwd:"",
              pwd:"",
              userService:"",
              code:"",
              imgCode:"",
              ucode:"",
            }
            var stringParams = JSON.stringify(params,userReplacer).replace(/\"/g, "").replace(/\:/g, '=').replace(/\,/g, '&').replace(/\{/g, '').replace(/\}/g, '')
            params.sign = md5(stringParams)
        $.ajax({
            type:"POST",
            url:proURL+"/userinfo",
            headers: {  
            "channel" : "cloudasr"
            },
            data:params,
            success:function(data){
                if(data.errorcode ==1024){
                    localStorage.clear()
                    Swal.fire({
                        text: i18n.get('firstLogin'),
                        showCancelButton: false,
                        allowOutsideClick:false,
                        allowEscapeKey:false,
                        reverseButtons:true,
                        width:'16em', 
                        confirmButtonColor: '#94cb82',
                        confirmButtonText: i18n.get('confirm'),
                    }).then((result)=>{
                        if (result.isConfirmed) {
                        var url = window.location.href
                        window.localStorage.setItem('returnurl',url)
                        window.location.href = '../login/login.html'
                        }
                    })
                }else{
                    $('#email').html(hideStar(data.email))
                    $('#phone').html(hideStar(data.phone))
                    $('#company').html(data.company)
                    $('#dept').html(data.dept)
                    $('#username').html(data.userName)
                    $('#qx').html(data.userService == 1 ? '短语音' : data.userService == 2 ? '长语音' : data.userService == 3 ? '短语音、长语音' : ' ')
                }
            },
            error:function(){
                $('.user').css("display","none")
                $('.login-reg').css("display","block")
            }
        })
      }
      function hideStar(str){
          if(str !=null){
                if(str.length < 7 && str.length != 0){
                    return str.substring(0,1).concat("****")
                }else{
                    return str.substring(0,3) + "****" + str.substring(str.length - 4)
                }
          }else{
              return str
          }
            
        }
  </script>

</body>

</html>